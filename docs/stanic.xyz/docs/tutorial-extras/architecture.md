---
sidebar_position: 3
---

# æ¶æ„è®¾è®¡

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»é’ï¼ˆQingï¼‰é¡¹ç›®çš„æŠ€æœ¯æ¶æ„ã€è®¾è®¡ç†å¿µå’Œæ ¸å¿ƒç»„ä»¶ã€‚

## ğŸ—ï¸ æ•´ä½“æ¶æ„

### æ¶æ„æ¦‚è§ˆ

é’ï¼ˆQingï¼‰é‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼ŒåŸºäº Spring Cloud ç”Ÿæ€æ„å»ºï¼Œå…·æœ‰é«˜å¯ç”¨ã€å¯æ‰©å±•ã€æ˜“ç»´æŠ¤çš„ç‰¹ç‚¹ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å®¢æˆ·ç«¯å±‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Web å‰ç«¯    â”‚  ç§»åŠ¨ç«¯ App   â”‚  ç¬¬ä¸‰æ–¹åº”ç”¨   â”‚  ç®¡ç†åå°      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç½‘å…³å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              Spring Cloud Gateway                           â”‚
â”‚  â€¢ è·¯ç”±è½¬å‘  â€¢ è´Ÿè½½å‡è¡¡  â€¢ é™æµç†”æ–­  â€¢ è®¤è¯é‰´æƒ              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æœåŠ¡å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è®¤è¯æœåŠ¡    â”‚  åŠ¨æ¼«æœåŠ¡     â”‚  ç”¨æˆ·æœåŠ¡     â”‚  é€šçŸ¥æœåŠ¡      â”‚
â”‚  Auth        â”‚  Anime        â”‚  User         â”‚  Notification  â”‚
â”‚  Service     â”‚  Service      â”‚  Service      â”‚  Service       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åŸºç¡€è®¾æ–½å±‚                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æœåŠ¡æ³¨å†Œ    â”‚  é…ç½®ä¸­å¿ƒ     â”‚  æ¶ˆæ¯é˜Ÿåˆ—     â”‚  ç¼“å­˜          â”‚
â”‚  Eureka      â”‚  Config       â”‚  RabbitMQ     â”‚  Redis         â”‚
â”‚              â”‚  Server       â”‚               â”‚                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®å­˜å‚¨    â”‚  æ–‡ä»¶å­˜å‚¨     â”‚  ç›‘æ§         â”‚  æ—¥å¿—          â”‚
â”‚  MySQL       â”‚  MinIO        â”‚  Prometheus   â”‚  ELK Stack     â”‚
â”‚  MongoDB     â”‚  OSS          â”‚  Grafana      â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¶æ„ç‰¹ç‚¹

#### ğŸ”„ å¾®æœåŠ¡æ¶æ„

- **æœåŠ¡æ‹†åˆ†**: æŒ‰ä¸šåŠ¡é¢†åŸŸæ‹†åˆ†ä¸ºç‹¬ç«‹çš„å¾®æœåŠ¡
- **ç‹¬ç«‹éƒ¨ç½²**: æ¯ä¸ªæœåŠ¡å¯ç‹¬ç«‹å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²
- **æŠ€æœ¯æ ˆçµæ´»**: ä¸åŒæœåŠ¡å¯é€‰æ‹©æœ€é€‚åˆçš„æŠ€æœ¯æ ˆ
- **æ•…éšœéš”ç¦»**: å•ä¸ªæœåŠ¡æ•…éšœä¸å½±å“æ•´ä½“ç³»ç»Ÿ

#### ğŸŒ äº‘åŸç”Ÿè®¾è®¡

- **å®¹å™¨åŒ–**: åŸºäº Docker å®¹å™¨åŒ–éƒ¨ç½²
- **ç¼–æ’ç®¡ç†**: æ”¯æŒ Kubernetes ç¼–æ’
- **å¼¹æ€§ä¼¸ç¼©**: æ ¹æ®è´Ÿè½½è‡ªåŠ¨æ‰©ç¼©å®¹
- **æœåŠ¡ç½‘æ ¼**: æ”¯æŒ Istio æœåŠ¡ç½‘æ ¼

#### ğŸ” å®‰å…¨ä¼˜å…ˆ

- **é›¶ä¿¡ä»»æ¶æ„**: æœåŠ¡é—´é€šä¿¡å…¨ç¨‹åŠ å¯†
- **å¤šå±‚é˜²æŠ¤**: ç½‘å…³ã€æœåŠ¡ã€æ•°æ®å¤šå±‚å®‰å…¨é˜²æŠ¤
- **æƒé™æ§åˆ¶**: åŸºäº RBAC çš„ç»†ç²’åº¦æƒé™æ§åˆ¶
- **å®¡è®¡æ—¥å¿—**: å®Œæ•´çš„æ“ä½œå®¡è®¡é“¾è·¯

## ğŸ§© æ ¸å¿ƒç»„ä»¶

### æœåŠ¡æ³¨å†Œä¸å‘ç°

#### Eureka Server

```yaml
# é…ç½®ç¤ºä¾‹
eureka:
  instance:
    hostname: eureka-server
    prefer-ip-address: true
  client:
    register-with-eureka: false
    fetch-registry: false
    service-url:
      defaultZone: http://localhost:8761/eureka/
  server:
    enable-self-preservation: false
    eviction-interval-timer-in-ms: 5000
```

**åŠŸèƒ½ç‰¹æ€§**ï¼š

- æœåŠ¡è‡ªåŠ¨æ³¨å†Œå’Œå‘ç°
- å¥åº·æ£€æŸ¥å’Œæ•…éšœè½¬ç§»
- è´Ÿè½½å‡è¡¡æ”¯æŒ
- é›†ç¾¤éƒ¨ç½²é«˜å¯ç”¨

#### æœåŠ¡æ³¨å†Œæµç¨‹

```mermaid
sequenceDiagram
    participant S as å¾®æœåŠ¡
    participant E as Eureka Server
    participant C as å®¢æˆ·ç«¯
    
    S->>E: 1. æœåŠ¡æ³¨å†Œ
    E->>E: 2. å­˜å‚¨æœåŠ¡ä¿¡æ¯
    S->>E: 3. å‘é€å¿ƒè·³
    C->>E: 4. æœåŠ¡å‘ç°
    E->>C: 5. è¿”å›æœåŠ¡åˆ—è¡¨
    C->>S: 6. è°ƒç”¨æœåŠ¡
```

### é…ç½®ç®¡ç†

#### Spring Cloud Config

```yaml
# é…ç½®æœåŠ¡å™¨
spring:
  cloud:
    config:
      server:
        git:
          uri: https://github.com/stanic-xyz/qing-config
          search-paths: '{application}'
          clone-on-start: true
        encrypt:
          enabled: true
```

**é…ç½®å±‚æ¬¡ç»“æ„**ï¼š

```
config-repo/
â”œâ”€â”€ application.yml              # å…¨å±€é…ç½®
â”œâ”€â”€ application-dev.yml          # å¼€å‘ç¯å¢ƒ
â”œâ”€â”€ application-test.yml         # æµ‹è¯•ç¯å¢ƒ
â”œâ”€â”€ application-prod.yml         # ç”Ÿäº§ç¯å¢ƒ
â”œâ”€â”€ qing-service-anime.yml       # åŠ¨æ¼«æœåŠ¡é…ç½®
â”œâ”€â”€ qing-service-auth.yml        # è®¤è¯æœåŠ¡é…ç½®
â””â”€â”€ qing-gateway.yml             # ç½‘å…³é…ç½®
```

**é…ç½®åˆ·æ–°æœºåˆ¶**ï¼š

- æ”¯æŒåŠ¨æ€é…ç½®åˆ·æ–°
- åŸºäº Spring Cloud Bus çš„é…ç½®å¹¿æ’­
- é…ç½®å˜æ›´é€šçŸ¥æœºåˆ¶

### API ç½‘å…³

#### Spring Cloud Gateway

```yaml
# è·¯ç”±é…ç½®
spring:
  cloud:
    gateway:
      routes:
        - id: anime-service
          uri: lb://qing-service-anime
          predicates:
            - Path=/api/v1/animes/**
          filters:
            - StripPrefix=2
            - name: RequestRateLimiter
              args:
                redis-rate-limiter.replenishRate: 10
                redis-rate-limiter.burstCapacity: 20
```

**ç½‘å…³åŠŸèƒ½**ï¼š

- ğŸš¦ **è·¯ç”±è½¬å‘**: æ™ºèƒ½è·¯ç”±åˆ°åç«¯æœåŠ¡
- âš–ï¸ **è´Ÿè½½å‡è¡¡**: å¤šç§è´Ÿè½½å‡è¡¡ç­–ç•¥
- ğŸ›¡ï¸ **é™æµç†”æ–­**: ä¿æŠ¤åç«¯æœåŠ¡ç¨³å®šæ€§
- ğŸ” **è®¤è¯é‰´æƒ**: ç»Ÿä¸€çš„å®‰å…¨æ§åˆ¶å…¥å£
- ğŸ“Š **ç›‘æ§æ—¥å¿—**: å®Œæ•´çš„è¯·æ±‚é“¾è·¯è¿½è¸ª

#### ç½‘å…³è¿‡æ»¤å™¨é“¾

```mermaid
flowchart LR
    A[è¯·æ±‚] --> B[å…¨å±€å‰ç½®è¿‡æ»¤å™¨]
    B --> C[è·¯ç”±å‰ç½®è¿‡æ»¤å™¨]
    C --> D[è®¤è¯è¿‡æ»¤å™¨]
    D --> E[é™æµè¿‡æ»¤å™¨]
    E --> F[è·¯ç”±åˆ°åç«¯æœåŠ¡]
    F --> G[è·¯ç”±åç½®è¿‡æ»¤å™¨]
    G --> H[å…¨å±€åç½®è¿‡æ»¤å™¨]
    H --> I[å“åº”]
```

## ğŸ¯ ä¸šåŠ¡æœåŠ¡è®¾è®¡

### åŠ¨æ¼«æœåŠ¡ (Anime Service)

#### é¢†åŸŸæ¨¡å‹

```java
// åŠ¨æ¼«èšåˆæ ¹
@Entity
@Table(name = "anime")
public class Anime {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(nullable = false)
    private String name;
    
    @Lob
    private String description;
    
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "category_id")
    private AnimeCategory category;
    
    @Enumerated(EnumType.STRING)
    private AnimeStatus status;
    
    @OneToMany(mappedBy = "anime", cascade = CascadeType.ALL)
    private List<Episode> episodes;
    
    // é¢†åŸŸæ–¹æ³•
    public void updateStatus(AnimeStatus newStatus) {
        // ä¸šåŠ¡è§„åˆ™éªŒè¯
        if (this.status == AnimeStatus.COMPLETED && 
            newStatus == AnimeStatus.ONGOING) {
            throw new BusinessException("å·²å®Œç»“åŠ¨æ¼«ä¸èƒ½æ”¹ä¸ºè¿è½½ä¸­");
        }
        this.status = newStatus;
    }
}
```

#### åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Controller å±‚             â”‚
â”‚  â€¢ REST API æ¥å£                    â”‚
â”‚  â€¢ å‚æ•°éªŒè¯                         â”‚
â”‚  â€¢ å¼‚å¸¸å¤„ç†                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Service å±‚               â”‚
â”‚  â€¢ ä¸šåŠ¡é€»è¾‘å¤„ç†                     â”‚
â”‚  â€¢ äº‹åŠ¡ç®¡ç†                         â”‚
â”‚  â€¢ é¢†åŸŸæœåŠ¡                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Repository å±‚            â”‚
â”‚  â€¢ æ•°æ®è®¿é—®æŠ½è±¡                     â”‚
â”‚  â€¢ æŸ¥è¯¢ä¼˜åŒ–                         â”‚
â”‚  â€¢ ç¼“å­˜ç®¡ç†                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Infrastructure å±‚        â”‚
â”‚  â€¢ æ•°æ®åº“å®ç°                       â”‚
â”‚  â€¢ å¤–éƒ¨æœåŠ¡é›†æˆ                     â”‚
â”‚  â€¢ æ¶ˆæ¯å‘é€                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### CQRS æ¨¡å¼å®ç°

```java
// å‘½ä»¤å¤„ç†
@Component
public class AnimeCommandHandler {
    
    @Autowired
    private AnimeRepository animeRepository;
    
    @Autowired
    private DomainEventPublisher eventPublisher;
    
    @Transactional
    public void handle(CreateAnimeCommand command) {
        // 1. ä¸šåŠ¡è§„åˆ™éªŒè¯
        validateAnimeCreation(command);
        
        // 2. åˆ›å»ºèšåˆæ ¹
        Anime anime = new Anime(command.getName(), 
                               command.getDescription(),
                               command.getCategoryId());
        
        // 3. ä¿å­˜åˆ°æ•°æ®åº“
        animeRepository.save(anime);
        
        // 4. å‘å¸ƒé¢†åŸŸäº‹ä»¶
        eventPublisher.publish(new AnimeCreatedEvent(anime.getId()));
    }
}

// æŸ¥è¯¢å¤„ç†
@Component
public class AnimeQueryHandler {
    
    @Autowired
    private AnimeReadModelRepository readModelRepository;
    
    public Page<AnimeListVO> handle(AnimeListQuery query) {
        return readModelRepository.findAnimeList(
            query.getKeyword(),
            query.getCategory(),
            query.getPageable()
        );
    }
}
```

### è®¤è¯æœåŠ¡ (Auth Service)

#### JWT è®¤è¯æ¶æ„

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant G as ç½‘å…³
    participant A as è®¤è¯æœåŠ¡
    participant S as ä¸šåŠ¡æœåŠ¡
    participant R as Redis
    
    U->>G: 1. ç™»å½•è¯·æ±‚
    G->>A: 2. è½¬å‘ç™»å½•è¯·æ±‚
    A->>A: 3. éªŒè¯ç”¨æˆ·å‡­è¯
    A->>R: 4. å­˜å‚¨ä¼šè¯ä¿¡æ¯
    A->>G: 5. è¿”å› JWT Token
    G->>U: 6. è¿”å› Token
    
    U->>G: 7. ä¸šåŠ¡è¯·æ±‚ + Token
    G->>G: 8. éªŒè¯ Token
    G->>S: 9. è½¬å‘è¯·æ±‚
    S->>G: 10. è¿”å›å“åº”
    G->>U: 11. è¿”å›å“åº”
```

#### å®‰å…¨é…ç½®

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {
    
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        return http
            .csrf().disable()
            .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)
            .and()
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/api/v1/auth/login", "/api/v1/auth/register").permitAll()
                .requestMatchers("/api/v1/admin/**").hasRole("ADMIN")
                .anyRequest().authenticated()
            )
            .oauth2ResourceServer().jwt()
            .and()
            .build();
    }
    
    @Bean
    public JwtDecoder jwtDecoder() {
        return NimbusJwtDecoder.withSecretKey(getSecretKey()).build();
    }
}
```

## ğŸ’¾ æ•°æ®æ¶æ„

### æ•°æ®åº“è®¾è®¡

#### ä¸»æ•°æ®åº“ (MySQL)

```sql
-- åŠ¨æ¼«è¡¨
CREATE TABLE anime (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(255) NOT NULL COMMENT 'åŠ¨æ¼«åç§°',
    description TEXT COMMENT 'åŠ¨æ¼«æè¿°',
    category_id BIGINT NOT NULL COMMENT 'åˆ†ç±»ID',
    status ENUM('ONGOING', 'COMPLETED', 'SUSPENDED') NOT NULL COMMENT 'çŠ¶æ€',
    cover_image VARCHAR(500) COMMENT 'å°é¢å›¾ç‰‡',
    rating DECIMAL(3,1) DEFAULT 0.0 COMMENT 'è¯„åˆ†',
    episode_count INT DEFAULT 0 COMMENT 'é›†æ•°',
    release_date DATE COMMENT 'å‘å¸ƒæ—¥æœŸ',
    create_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    update_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_category_id (category_id),
    INDEX idx_status (status),
    INDEX idx_rating (rating),
    INDEX idx_create_time (create_time),
    FULLTEXT INDEX ft_name_desc (name, description)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- åˆ†ç±»è¡¨
CREATE TABLE anime_category (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL UNIQUE COMMENT 'åˆ†ç±»åç§°',
    description VARCHAR(500) COMMENT 'åˆ†ç±»æè¿°',
    sort_order INT DEFAULT 0 COMMENT 'æ’åº',
    create_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_sort_order (sort_order)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ç”¨æˆ·è¡¨
CREATE TABLE user (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(100) NOT NULL UNIQUE COMMENT 'ç”¨æˆ·å',
    password VARCHAR(255) NOT NULL COMMENT 'å¯†ç ',
    email VARCHAR(255) NOT NULL UNIQUE COMMENT 'é‚®ç®±',
    nickname VARCHAR(100) COMMENT 'æ˜µç§°',
    avatar VARCHAR(500) COMMENT 'å¤´åƒ',
    status ENUM('ACTIVE', 'INACTIVE', 'LOCKED') DEFAULT 'ACTIVE' COMMENT 'çŠ¶æ€',
    last_login_time TIMESTAMP NULL COMMENT 'æœ€åç™»å½•æ—¶é—´',
    create_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    update_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_email (email),
    INDEX idx_status (status),
    INDEX idx_create_time (create_time)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

#### ç¼“å­˜è®¾è®¡ (Redis)

```yaml
# Redis æ•°æ®ç»“æ„è®¾è®¡

# ç”¨æˆ·ä¼šè¯ç¼“å­˜
user:session:{userId}: {
  "token": "jwt-token",
  "refreshToken": "refresh-token",
  "loginTime": "2024-01-01T12:00:00",
  "expireTime": "2024-01-01T13:00:00"
}

# åŠ¨æ¼«è¯¦æƒ…ç¼“å­˜
anime:detail:{animeId}: {
  "id": 1,
  "name": "è¿›å‡»çš„å·¨äºº",
  "description": "...",
  "category": {...},
  "episodes": [...]
}

# çƒ­é—¨åŠ¨æ¼«æ’è¡Œæ¦œ
anime:ranking:hot: [
  {"id": 1, "name": "è¿›å‡»çš„å·¨äºº", "score": 9.5},
  {"id": 2, "name": "é¬¼ç­ä¹‹åˆƒ", "score": 9.3}
]

# åˆ†å¸ƒå¼é”
lock:anime:update:{animeId}: "lock-value"

# é™æµè®¡æ•°å™¨
rate_limit:{userId}:{api}: {
  "count": 10,
  "window": "2024-01-01T12:00:00"
}
```

#### æœç´¢å¼•æ“ (Elasticsearch)

```json
{
  "mappings": {
    "properties": {
      "id": {"type": "long"},
      "name": {
        "type": "text",
        "analyzer": "ik_max_word",
        "search_analyzer": "ik_smart",
        "fields": {
          "keyword": {"type": "keyword"}
        }
      },
      "description": {
        "type": "text",
        "analyzer": "ik_max_word"
      },
      "category": {
        "type": "nested",
        "properties": {
          "id": {"type": "long"},
          "name": {"type": "keyword"}
        }
      },
      "tags": {"type": "keyword"},
      "rating": {"type": "float"},
      "status": {"type": "keyword"},
      "releaseDate": {"type": "date"},
      "createTime": {"type": "date"}
    }
  }
}
```

### æ•°æ®ä¸€è‡´æ€§

#### åˆ†å¸ƒå¼äº‹åŠ¡

```java
@Service
@Transactional
public class AnimeService {
    
    @Autowired
    private AnimeRepository animeRepository;
    
    @Autowired
    private SearchService searchService;
    
    @Autowired
    private CacheService cacheService;
    
    // ä½¿ç”¨ Saga æ¨¡å¼å¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡
    public void createAnime(CreateAnimeCommand command) {
        try {
            // 1. ä¿å­˜åˆ°æ•°æ®åº“
            Anime anime = animeRepository.save(new Anime(command));
            
            // 2. æ›´æ–°æœç´¢ç´¢å¼•
            searchService.indexAnime(anime);
            
            // 3. æ¸…é™¤ç›¸å…³ç¼“å­˜
            cacheService.evictAnimeCache(anime.getCategoryId());
            
            // 4. å‘å¸ƒäº‹ä»¶
            eventPublisher.publish(new AnimeCreatedEvent(anime));
            
        } catch (Exception e) {
            // è¡¥å¿æ“ä½œ
            compensateAnimeCreation(command);
            throw e;
        }
    }
}
```

#### æœ€ç»ˆä¸€è‡´æ€§

```java
// äº‹ä»¶é©±åŠ¨çš„æœ€ç»ˆä¸€è‡´æ€§
@EventListener
public class AnimeEventHandler {
    
    @Async
    @Retryable(value = Exception.class, maxAttempts = 3)
    public void handleAnimeCreated(AnimeCreatedEvent event) {
        // å¼‚æ­¥æ›´æ–°è¯»æ¨¡å‹
        updateAnimeReadModel(event.getAnimeId());
        
        // å¼‚æ­¥æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        updateCategoryStatistics(event.getCategoryId());
        
        // å¼‚æ­¥å‘é€é€šçŸ¥
        sendNotification(event);
    }
}
```

## ğŸ”„ æ¶ˆæ¯é©±åŠ¨æ¶æ„

### äº‹ä»¶é©±åŠ¨è®¾è®¡

```mermaid
flowchart TD
    A[ç”¨æˆ·æ“ä½œ] --> B[å‘½ä»¤å¤„ç†]
    B --> C[é¢†åŸŸäº‹ä»¶]
    C --> D[äº‹ä»¶æ€»çº¿]
    D --> E[äº‹ä»¶å¤„ç†å™¨1]
    D --> F[äº‹ä»¶å¤„ç†å™¨2]
    D --> G[äº‹ä»¶å¤„ç†å™¨3]
    E --> H[æ›´æ–°è¯»æ¨¡å‹]
    F --> I[å‘é€é€šçŸ¥]
    G --> J[æ›´æ–°ç¼“å­˜]
```

### æ¶ˆæ¯é˜Ÿåˆ—é…ç½®

```yaml
# RabbitMQ é…ç½®
spring:
  rabbitmq:
    host: localhost
    port: 5672
    username: guest
    password: guest
    virtual-host: /
    publisher-confirms: true
    publisher-returns: true
    listener:
      simple:
        acknowledge-mode: manual
        retry:
          enabled: true
          max-attempts: 3
          initial-interval: 1000
```

```java
// æ¶ˆæ¯é˜Ÿåˆ—é…ç½®
@Configuration
public class RabbitConfig {
    
    // åŠ¨æ¼«äº‹ä»¶äº¤æ¢æœº
    @Bean
    public TopicExchange animeExchange() {
        return new TopicExchange("anime.exchange", true, false);
    }
    
    // åŠ¨æ¼«åˆ›å»ºé˜Ÿåˆ—
    @Bean
    public Queue animeCreatedQueue() {
        return QueueBuilder.durable("anime.created.queue")
            .withArgument("x-dead-letter-exchange", "anime.dlx")
            .withArgument("x-dead-letter-routing-key", "anime.created.dlq")
            .build();
    }
    
    // ç»‘å®šå…³ç³»
    @Bean
    public Binding animeCreatedBinding() {
        return BindingBuilder
            .bind(animeCreatedQueue())
            .to(animeExchange())
            .with("anime.created");
    }
}
```

## ğŸ“Š ç›‘æ§ä¸å¯è§‚æµ‹æ€§

### ç›‘æ§æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç›‘æ§å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Grafana Dashboard  â”‚  Alertmanager  â”‚  Jaeger UI           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        é‡‡é›†å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Prometheus         â”‚  Jaeger        â”‚  ELK Stack           â”‚
â”‚  â€¢ æŒ‡æ ‡é‡‡é›†         â”‚  â€¢ é“¾è·¯è¿½è¸ª    â”‚  â€¢ æ—¥å¿—èšåˆ          â”‚
â”‚  â€¢ æ—¶åºæ•°æ®åº“       â”‚  â€¢ æ€§èƒ½åˆ†æ    â”‚  â€¢ æ—¥å¿—åˆ†æ          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åº”ç”¨å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Micrometer         â”‚  OpenTracing   â”‚  Logback             â”‚
â”‚  â€¢ æŒ‡æ ‡æš´éœ²         â”‚  â€¢ é“¾è·¯åŸ‹ç‚¹    â”‚  â€¢ ç»“æ„åŒ–æ—¥å¿—        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®æŒ‡æ ‡

```yaml
# ä¸šåŠ¡æŒ‡æ ‡
business_metrics:
  - anime_total_count          # åŠ¨æ¼«æ€»æ•°
  - anime_created_daily        # æ¯æ—¥æ–°å¢åŠ¨æ¼«æ•°
  - user_active_count          # æ´»è·ƒç”¨æˆ·æ•°
  - api_request_rate           # API è¯·æ±‚é€Ÿç‡

# æŠ€æœ¯æŒ‡æ ‡
technical_metrics:
  - jvm_memory_usage           # JVM å†…å­˜ä½¿ç”¨ç‡
  - database_connection_pool   # æ•°æ®åº“è¿æ¥æ± 
  - redis_connection_count     # Redis è¿æ¥æ•°
  - response_time_percentile   # å“åº”æ—¶é—´åˆ†ä½æ•°

# åŸºç¡€è®¾æ–½æŒ‡æ ‡
infrastructure_metrics:
  - cpu_usage_percent          # CPU ä½¿ç”¨ç‡
  - memory_usage_percent       # å†…å­˜ä½¿ç”¨ç‡
  - disk_usage_percent         # ç£ç›˜ä½¿ç”¨ç‡
  - network_io_bytes           # ç½‘ç»œ IO
```

### é“¾è·¯è¿½è¸ª

```java
@RestController
public class AnimeController {
    
    @Autowired
    private AnimeService animeService;
    
    @GetMapping("/animes/{id}")
    @Traced(operationName = "get-anime-detail")
    public ResponseEntity<AnimeVO> getAnime(@PathVariable Long id) {
        Span span = tracer.nextSpan()
            .name("anime-controller-get-detail")
            .tag("anime.id", String.valueOf(id))
            .start();
        
        try (Tracer.SpanInScope ws = tracer.withSpanInScope(span)) {
            AnimeVO anime = animeService.getAnimeDetail(id);
            span.tag("anime.name", anime.getName());
            return ResponseEntity.ok(anime);
        } catch (Exception e) {
            span.tag("error", e.getMessage());
            throw e;
        } finally {
            span.end();
        }
    }
}
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥

#### å¤šçº§ç¼“å­˜æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æµè§ˆå™¨     â”‚    â”‚   CDN       â”‚    â”‚   Nginx     â”‚
â”‚   ç¼“å­˜       â”‚    â”‚   ç¼“å­˜       â”‚    â”‚   ç¼“å­˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åº”ç”¨ç¼“å­˜    â”‚    â”‚   Redis     â”‚    â”‚   æ•°æ®åº“     â”‚
â”‚  (Caffeine) â”‚    â”‚   ç¼“å­˜       â”‚    â”‚   ç¼“å­˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ç¼“å­˜å®ç°

```java
@Service
public class AnimeService {
    
    @Cacheable(value = "anime:detail", key = "#id", unless = "#result == null")
    public AnimeVO getAnimeDetail(Long id) {
        return animeRepository.findById(id)
            .map(this::convertToVO)
            .orElse(null);
    }
    
    @CacheEvict(value = "anime:detail", key = "#anime.id")
    @CachePut(value = "anime:list", key = "#anime.categoryId")
    public AnimeVO updateAnime(Anime anime) {
        Anime saved = animeRepository.save(anime);
        return convertToVO(saved);
    }
}
```

### æ•°æ®åº“ä¼˜åŒ–

#### è¯»å†™åˆ†ç¦»

```java
@Configuration
public class DataSourceConfig {
    
    @Bean
    @Primary
    public DataSource dataSource() {
        return new RoutingDataSource();
    }
    
    @Bean
    public DataSource masterDataSource() {
        return DataSourceBuilder.create()
            .url("jdbc:mysql://master:3306/qing")
            .build();
    }
    
    @Bean
    public DataSource slaveDataSource() {
        return DataSourceBuilder.create()
            .url("jdbc:mysql://slave:3306/qing")
            .build();
    }
}

// åŠ¨æ€æ•°æ®æºè·¯ç”±
public class RoutingDataSource extends AbstractRoutingDataSource {
    
    @Override
    protected Object determineCurrentLookupKey() {
        return DataSourceContextHolder.getDataSourceType();
    }
}
```

#### åˆ†åº“åˆ†è¡¨

```java
// ShardingSphere é…ç½®
@Configuration
public class ShardingConfig {
    
    @Bean
    public DataSource shardingDataSource() {
        // åˆ†åº“ç­–ç•¥ï¼šæŒ‰ç”¨æˆ·IDåˆ†åº“
        DatabaseShardingStrategyConfiguration dbStrategy = 
            new DatabaseShardingStrategyConfiguration(
                "user_id", 
                new UserDatabaseShardingAlgorithm()
            );
        
        // åˆ†è¡¨ç­–ç•¥ï¼šæŒ‰åˆ›å»ºæ—¶é—´åˆ†è¡¨
        TableShardingStrategyConfiguration tableStrategy = 
            new TableShardingStrategyConfiguration(
                "create_time", 
                new TimeBasedTableShardingAlgorithm()
            );
        
        return ShardingDataSourceFactory.createDataSource(
            createDataSourceMap(), 
            createShardingRuleConfig(dbStrategy, tableStrategy), 
            new Properties()
        );
    }
}
```

### å¼‚æ­¥å¤„ç†

```java
@Service
public class AnimeService {
    
    @Async("taskExecutor")
    @Retryable(value = Exception.class, maxAttempts = 3)
    public CompletableFuture<Void> processAnimeAsync(Long animeId) {
        // å¼‚æ­¥å¤„ç†åŠ¨æ¼«ç›¸å…³ä»»åŠ¡
        // 1. ç”Ÿæˆç¼©ç•¥å›¾
        generateThumbnail(animeId);
        
        // 2. æ›´æ–°æœç´¢ç´¢å¼•
        updateSearchIndex(animeId);
        
        // 3. å‘é€é€šçŸ¥
        sendNotification(animeId);
        
        return CompletableFuture.completedFuture(null);
    }
}

@Configuration
@EnableAsync
public class AsyncConfig {
    
    @Bean("taskExecutor")
    public TaskExecutor taskExecutor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(10);
        executor.setMaxPoolSize(50);
        executor.setQueueCapacity(200);
        executor.setThreadNamePrefix("async-task-");
        executor.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy());
        executor.initialize();
        return executor;
    }
}
```

## ğŸ”’ å®‰å…¨æ¶æ„

### å®‰å…¨é˜²æŠ¤ä½“ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å®‰å…¨é˜²æŠ¤å±‚                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  WAF        â”‚  DDoS é˜²æŠ¤   â”‚  IP ç™½åå•   â”‚  SSL/TLS       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç½‘å…³å®‰å…¨å±‚                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è®¤è¯é‰´æƒ    â”‚  é™æµç†”æ–­     â”‚  å‚æ•°æ ¡éªŒ     â”‚  æ—¥å¿—å®¡è®¡      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åº”ç”¨å®‰å…¨å±‚                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¾“å…¥éªŒè¯    â”‚  SQL æ³¨å…¥é˜²æŠ¤ â”‚  XSS é˜²æŠ¤    â”‚  CSRF é˜²æŠ¤     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®å®‰å…¨å±‚                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®åŠ å¯†    â”‚  è®¿é—®æ§åˆ¶     â”‚  å¤‡ä»½æ¢å¤     â”‚  å®¡è®¡æ—¥å¿—      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æƒé™æ§åˆ¶æ¨¡å‹

```java
// RBAC æƒé™æ¨¡å‹
@Entity
public class User {
    @ManyToMany(fetch = FetchType.LAZY)
    @JoinTable(name = "user_role",
               joinColumns = @JoinColumn(name = "user_id"),
               inverseJoinColumns = @JoinColumn(name = "role_id"))
    private Set<Role> roles;
}

@Entity
public class Role {
    @ManyToMany(fetch = FetchType.LAZY)
    @JoinTable(name = "role_permission",
               joinColumns = @JoinColumn(name = "role_id"),
               inverseJoinColumns = @JoinColumn(name = "permission_id"))
    private Set<Permission> permissions;
}

@Entity
public class Permission {
    private String resource;  // èµ„æº
    private String action;    // æ“ä½œ
    private String effect;    // æ•ˆæœï¼šALLOW/DENY
}
```

## ğŸ“š ç›¸å…³èµ„æº

- [å¿«é€Ÿå¼€å§‹](../tutorial-basics/getting-started) - é¡¹ç›®å®‰è£…å’Œå¯åŠ¨æŒ‡å—
- [API æ–‡æ¡£](./api-docs) - è¯¦ç»†çš„ API æ¥å£æ–‡æ¡£
- [å¼€å‘æŒ‡å—](./development) - å¼€å‘è§„èŒƒå’Œæœ€ä½³å®è·µ
- [éƒ¨ç½²æŒ‡å—](../tutorial-basics/deployment) - ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—

## ğŸ†˜ è·å–å¸®åŠ©

å¦‚æœå¯¹æ¶æ„è®¾è®¡æœ‰ç–‘é—®ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–å¸®åŠ©ï¼š

- ğŸ“– æŸ¥çœ‹å®Œæ•´æ–‡æ¡£
- ğŸ› [æäº¤ Issue](https://github.com/stanic-xyz/qing/issues)
- ğŸ’¬ [å‚ä¸è®¨è®º](https://github.com/stanic-xyz/qing/discussions)
- ğŸ“§ å‘é€é‚®ä»¶ï¼šsupport@example.com

---

> ğŸ’¡ **æç¤º**ï¼šæ¶æ„è®¾è®¡ä¼šéšç€ä¸šåŠ¡å‘å±•æŒç»­æ¼”è¿›ï¼Œå»ºè®®å®šæœŸå›é¡¾å’Œä¼˜åŒ–ã€‚æ‰€æœ‰è®¾è®¡å†³ç­–éƒ½åº”è¯¥åŸºäºå®é™…ä¸šåŠ¡éœ€æ±‚å’ŒæŠ€æœ¯çº¦æŸã€‚
